# 破坏

本指南面向希望构建高可用应用的应用管理员，并需要了解什么样的破坏可能发生在pod上。

## 自愿和非自愿中断

pods不会主动消失，直到某人删除，或者存在不可避免的硬件和系统软件错误。

对于应用来说，我们称呼这些不可避免的场景为非自愿中断。例如：
* 支持该节点的物理机发生故障
* 集群管理员失误删除虚拟机实例
* 云厂商或者hypervisor错误，导致虚拟机实例消失
* 内核异常
* 由于网络划分导致节点从集群中消失
* 由于节点资源不足将pod驱逐

除了资源不足的场景，大多数用户都对所有的场景熟悉，这些并不是kubernete特有的。

我们称呼其他的场景为自愿中断。这些包含程序拥有者的初始化动作，以及集群管理员的初始化动作，典型的程序拥有者的动作包含：
* 删除deployment或者其他的管理pod的控制器
* 更新一个deployment导致重启
* 直接删除一个pod

集群管理员的动作包含：
* 清空节点以维修或者升级
* 排空节点，以缩小集群
* 从一个节点移除pod，以供其他事物使用节点

这些动作可能由集群管理员直接操作，或者由集群管理员定义的自动程序执行，或者由集群主机提供商执行。

请您的群集管理员或咨询您的云提供商或发行文档，以确定是否为您的群集启用了任何自愿中断源。 如果未启用任何一项，则可以跳过创建Pod中断预算的操作。

注意：并非所有自愿中断都受到Pod中断预算的限制。 例如，删除部署或Pod将绕过Pod中断预算。

## 应对破坏

以下是几种应对被动中断的方法：
* 保证你的pod请求所需的资源
* 如果你的程序需要更高的可用性，使用多副本的方式
* 对于更高的可用性要求，可以将程序分布到跨区域

自愿中断的频率各不相同。 在基本的Kubernetes集群上，没有自动的自愿中断（只有用户触发的中断）。 但是，您的群集管理员或主机提供商可能会运行一些其他服务，这些服务会导致自愿中断。 例如，推出节点软件更新可能会导致自愿中断。 同样，群集（节点）自动缩放的某些实现可能会导致对碎片整理和紧凑型节点的自愿中断。 您的集群管理员或主机提供商应已记录了预期的自愿中断级别（如果有）。 某些配置选项，例如在pod规范中使用PriorityClasses，也可能导致自愿（和非自愿）中断。






